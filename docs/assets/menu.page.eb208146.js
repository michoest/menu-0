import{i as le,av as Ie,c as J,o as oe,h,Y as qe,aw as Ve,u as ie,r as S,a as _,x as N,w as Te,aa as Le,d as $e,g as ue,Q as B,s as se,ax as Ae,ay as Be,az as Qe,aA as De,R as Ee,a6 as Y,a7 as de,H as p,I as L,J as i,K as l,a8 as D,a9 as F,U as $,ab as w,ac as j,ae as R,ad as G,af as I,aB as te,M as z,aC as je,j as Re}from"./index.f9343e25.js";import{u as Me,a as Oe,b as Ne,c as Pe,A as H,z as A,B as V,t as Z,o as U,q as P,s as ce,Q as re,_ as M,v as ne,w as ze,x as me,C as ae,y as He}from"./QCard.bbddaae7.js";import{h as ve,i as fe,u as Ue,Q as K,f as Ke}from"./store.6bae0c8f.js";import{Q as Fe}from"./QPage.5a12eee6.js";import"./axios.ab682c6b.js";import"./notify.8d25b101.js";function Ye(){return le(Ie)}var Ge=J({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:y,emit:g}){let r=!1,d,s,m=null,c=null,v,f;function k(){d&&d(),d=null,r=!1,m!==null&&(clearTimeout(m),m=null),c!==null&&(clearTimeout(c),c=null),s!==void 0&&s.removeEventListener("transitionend",v),v=null}function b(n,t,o){t!==void 0&&(n.style.height=`${t}px`),n.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,r=!0,d=o}function x(n,t){n.style.overflowY=null,n.style.height=null,n.style.transition=null,k(),t!==f&&g(t)}function q(n,t){let o=0;s=n,r===!0?(k(),o=n.offsetHeight===n.scrollHeight?0:void 0):(f="hide",n.style.overflowY="hidden"),b(n,o,t),m=setTimeout(()=>{m=null,n.style.height=`${n.scrollHeight}px`,v=C=>{c=null,(Object(C)!==C||C.target===n)&&x(n,"show")},n.addEventListener("transitionend",v),c=setTimeout(v,e.duration*1.1)},100)}function a(n,t){let o;s=n,r===!0?k():(f="show",n.style.overflowY="hidden",o=n.scrollHeight),b(n,o,t),m=setTimeout(()=>{m=null,n.style.height=0,v=C=>{c=null,(Object(C)!==C||C.target===n)&&x(n,"hide")},n.addEventListener("transitionend",v),c=setTimeout(v,e.duration*1.1)},100)}return oe(()=>{r===!0&&k()}),()=>h(qe,{css:!1,appear:e.appear,onEnter:q,onLeave:a},y.default)}});const Q=Ve({}),Je=Object.keys(ie);var Ze=J({name:"QExpansionItem",props:{...ie,...Me,...ve,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:{},headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...Oe,"click","afterShow","afterHide"],setup(e,{slots:y,emit:g}){const{proxy:{$q:r}}=ue(),d=fe(e,r),s=S(e.modelValue!==null?e.modelValue:e.defaultOpened),m=S(null),c=Ne(),{show:v,hide:f,toggle:k}=Pe({showing:s});let b,x;const q=_(()=>`q-expansion-item q-item-type q-expansion-item--${s.value===!0?"expanded":"collapsed"} q-expansion-item--${e.popup===!0?"popup":"standard"}`),a=_(()=>{if(e.contentInsetLevel===void 0)return null;const u=r.lang.rtl===!0?"Right":"Left";return{["padding"+u]:e.contentInsetLevel*56+"px"}}),n=_(()=>e.disable!==!0&&(e.href!==void 0||e.to!==void 0&&e.to!==null&&e.to!=="")),t=_(()=>{const u={};return Je.forEach(T=>{u[T]=e[T]}),u}),o=_(()=>n.value===!0||e.expandIconToggle!==!0),C=_(()=>e.expandedIcon!==void 0&&s.value===!0?e.expandedIcon:e.expandIcon||r.iconSet.expansionItem[e.denseToggle===!0?"denseIcon":"icon"]),E=_(()=>e.disable!==!0&&(n.value===!0||e.expandIconToggle===!0)),he=_(()=>({expanded:s.value===!0,detailsId:c.value,toggle:k,show:v,hide:f})),W=_(()=>{const u=e.toggleAriaLabel!==void 0?e.toggleAriaLabel:r.lang.label[s.value===!0?"collapse":"expand"](e.label);return{role:"button","aria-expanded":s.value===!0?"true":"false","aria-controls":c.value,"aria-label":u}});N(()=>e.group,u=>{x!==void 0&&x(),u!==void 0&&ee()});function ge(u){n.value!==!0&&k(u),g("click",u)}function be(u){u.keyCode===13&&X(u,!0)}function X(u,T){T!==!0&&m.value!==null&&m.value.focus(),k(u),se(u)}function _e(){g("afterShow")}function xe(){g("afterHide")}function ee(){b===void 0&&(b=Ue()),s.value===!0&&(Q[e.group]=b);const u=N(s,O=>{O===!0?Q[e.group]=b:Q[e.group]===b&&delete Q[e.group]}),T=N(()=>Q[e.group],(O,we)=>{we===b&&O!==void 0&&O!==b&&f()});x=()=>{u(),T(),Q[e.group]===b&&delete Q[e.group],x=void 0}}function ke(){const u={class:[`q-focusable relative-position cursor-pointer${e.denseToggle===!0&&e.switchToggleSide===!0?" items-end":""}`,e.expandIconClass],side:e.switchToggleSide!==!0,avatar:e.switchToggleSide},T=[h(B,{class:"q-expansion-item__toggle-icon"+(e.expandedIcon===void 0&&s.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:C.value})];return E.value===!0&&(Object.assign(u,{tabindex:0,...W.value,onClick:X,onKeyup:be}),T.unshift(h("div",{ref:m,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),h(V,u,()=>T)}function ye(){let u;return y.header!==void 0?u=[].concat(y.header(he.value)):(u=[h(V,()=>[h(A,{lines:e.labelLines},()=>e.label||""),e.caption?h(A,{lines:e.captionLines,caption:!0},()=>e.caption):null])],e.icon&&u[e.switchToggleSide===!0?"push":"unshift"](h(V,{side:e.switchToggleSide===!0,avatar:e.switchToggleSide!==!0},()=>h(B,{name:e.icon})))),e.disable!==!0&&e.hideExpandIcon!==!0&&u[e.switchToggleSide===!0?"unshift":"push"](ke()),u}function pe(){const u={ref:"item",style:e.headerStyle,class:e.headerClass,dark:d.value,disable:e.disable,dense:e.dense,insetLevel:e.headerInsetLevel};return o.value===!0&&(u.clickable=!0,u.onClick=ge,Object.assign(u,n.value===!0?t.value:W.value)),h(H,u,ye)}function Se(){return Te(h("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:a.value,id:c.value},$e(y.default)),[[Le,s.value]])}function Ce(){const u=[pe(),h(Ge,{duration:e.duration,onShow:_e,onHide:xe},Se)];return e.expandSeparator===!0&&u.push(h(K,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:d.value}),h(K,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:d.value})),u}return e.group!==void 0&&ee(),oe(()=>{x!==void 0&&x()}),()=>h("div",{class:q.value},[h("div",{class:"q-expansion-item__container relative-position"},Ce())])}});const We={xs:8,sm:10,md:14,lg:20,xl:24};var Xe=J({name:"QChip",props:{...ve,...Ae,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:y,emit:g}){const{proxy:{$q:r}}=ue(),d=fe(e,r),s=Be(e,We),m=_(()=>e.selected===!0||e.icon!==void 0),c=_(()=>e.selected===!0?e.iconSelected||r.iconSet.chip.selected:e.icon),v=_(()=>e.iconRemove||r.iconSet.chip.remove),f=_(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),k=_(()=>{const t=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(t?` text-${t} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(f.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(d.value===!0?" q-chip--dark q-dark":"")}),b=_(()=>{const t=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},o={...t,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||r.lang.label.remove};return{chip:t,remove:o}});function x(t){t.keyCode===13&&q(t)}function q(t){e.disable||(g("update:selected",!e.selected),g("click",t))}function a(t){(t.keyCode===void 0||t.keyCode===13)&&(se(t),e.disable===!1&&(g("update:modelValue",!1),g("remove")))}function n(){const t=[];f.value===!0&&t.push(h("div",{class:"q-focus-helper"})),m.value===!0&&t.push(h(B,{class:"q-chip__icon q-chip__icon--left",name:c.value}));const o=e.label!==void 0?[h("div",{class:"ellipsis"},[e.label])]:void 0;return t.push(h("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},De(y.default,o))),e.iconRight&&t.push(h(B,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&t.push(h(B,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:v.value,...b.value.remove,onClick:a,onKeyup:a})),t}return()=>{if(e.modelValue===!1)return;const t={class:k.value,style:s.value};return f.value===!0&&Object.assign(t,b.value.chip,{onClick:q,onKeyup:x}),Qe("div",t,n(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[Ee,e.ripple]])}}});const et={class:"q-px-md"},tt={class:"q-gutter-y-xs column"},nt={__name:"addIngredient.dialog.component",props:{modelValue:{},modelModifiers:{}},emits:Y(["add"],["update:modelValue"]),setup(e,{emit:y}){const g=de(e,"modelValue"),r=y,d=S({name:"",amount:{value:null,unit:""}}),s=()=>{g.value=!1,d.value.amount.value==""&&d.value.amount.unit==""&&(d.value.amount={value:null,unit:null}),r("add",M.cloneDeep(d.value))},m=()=>{d.value={name:"",amount:{value:null,unit:""}}};return(c,v)=>(p(),L(re,{modelValue:g.value,"onUpdate:modelValue":v[3]||(v[3]=f=>g.value=f),position:"bottom",onHide:m},{default:i(()=>[l(Z,{style:{width:"350px"},class:"q-px-md"},{default:i(()=>[l(U,null,{default:i(()=>[D("div",et,[D("div",tt,[l(P,{class:"text-body1",borderless:"",modelValue:d.value.name,"onUpdate:modelValue":v[0]||(v[0]=f=>d.value.name=f),dense:"",placeholder:"Title",autofocus:"",onKeyup:F(s,["enter"])},null,8,["modelValue"]),l(P,{borderless:"",modelValue:d.value.amount.value,"onUpdate:modelValue":v[1]||(v[1]=f=>d.value.amount.value=f),dense:"",placeholder:"Value",onKeyup:F(s,["enter"])},{prepend:i(()=>[l(B,{size:"xs",name:"123"})]),_:1},8,["modelValue"]),l(P,{borderless:"",modelValue:d.value.amount.unit,"onUpdate:modelValue":v[2]||(v[2]=f=>d.value.amount.unit=f),dense:"",placeholder:"Unit",onKeyup:F(s,["enter"])},{prepend:i(()=>[l(B,{size:"xs",name:"category"})]),_:1},8,["modelValue"])])])]),_:1}),l(ce,{align:"right"},{default:i(()=>[l($,{flat:"",onClick:s},{default:i(()=>[w("Add")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},at={__name:"chooseIngredients.dialog.component",props:Y({dishes:Array},{modelValue:{},modelModifiers:{}}),emits:Y(["add"],["update:modelValue"]),setup(e,{emit:y}){ne.extend(ze);const g=de(e,"modelValue"),r=e,d=y,s=S(M.cloneDeep(r.dishes));S(null),S({show:!1});const m=S({show:!1,dish:null,ingredient:{}}),c=S({show:!1,dish:null,ingredient:null});N(()=>r.dishes,a=>{s.value=M.cloneDeep(a)});const v=()=>{const a=s.value.flatMap(n=>n.dish.ingredients);d("add",a),g.value=!1},f=a=>{m.value.dish=a,m.value.show=!0},k=a=>{m.value.dish.dish.ingredients.push(a)},b=(a,n,t)=>{c.value.dish=a,c.value.ingredient=n,c.value.show=!0},x=async(a,n)=>{a.dish.ingredients.splice(n,1)},q=a=>{a.due?a.due=a.due.add(1,"d"):a.due=ne().add(1,"d")};return(a,n)=>(p(),j(R,null,[l(re,{modelValue:g.value,"onUpdate:modelValue":n[0]||(n[0]=t=>g.value=t),position:"bottom"},{default:i(()=>[l(Z,{style:{width:"350px"},class:"q-pa-sm"},{default:i(()=>[l(U,null,{default:i(()=>[l(me,null,{default:i(()=>[(p(!0),j(R,null,G(s.value,t=>(p(),j(R,{key:t.dish._id},[l(A,{header:""},{default:i(()=>[w(I(t.dish.title)+" ("+I(t.amount)+" Portionen)",1)]),_:2},1024),(p(!0),j(R,null,G(t.dish.ingredients,(o,C)=>(p(),L(H,{key:C},{default:i(()=>[l(V,{side:"",top:""},{default:i(()=>[l($,{size:"12px",flat:"",dense:"",round:"",color:"negative",icon:"remove_circle_outline",onClick:te(E=>x(t,C),["stop"])},null,8,["onClick"])]),_:2},1024),l(V,{clickable:"",onClick:E=>b(t,o)},{default:i(()=>[l(A,null,{default:i(()=>[w(I(o.name)+" ",1),o.subdish?(p(),L(ae,{key:0,class:"q-mx-sm",color:"secondary"},{default:i(()=>[w(I(o.subdish),1)]),_:2},1024)):z("",!0),o.optional?(p(),L(ae,{key:1,class:"q-mx-sm"},{default:i(()=>[w("Optional")]),_:1})):z("",!0),l(Xe,{removable:"",dense:"","model-value":!!o.due,onRemove:E=>o.due=null,class:"q-mx-sm",outline:"",color:"accent","text-color":"white"},{default:i(()=>[w(I(o.due.fromNow()),1)]),_:2},1032,["model-value","onRemove"])]),_:2},1024),l(A,{caption:""},{default:i(()=>[w(I(o.amount.value)+" "+I(o.amount.unit),1)]),_:2},1024)]),_:2},1032,["onClick"]),l(V,{side:""},{default:i(()=>[l($,{size:"12px",flat:"",dense:"",round:"",icon:"trending_flat",onClick:te(E=>q(o),["stop"])},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(H,{clickable:"",onClick:o=>f(t)},{default:i(()=>[l(V,{side:"",top:""},{default:i(()=>[l($,{size:"12px",flat:"",dense:"",round:"",color:"primary",icon:"add_circle_outline"})]),_:1}),l(V,null,{default:i(()=>[l(A,null,{default:i(()=>[w("Add ingredient...")]),_:1})]),_:1})]),_:2},1032,["onClick"])],64))),128))]),_:1})]),_:1}),l(K,{inset:""}),l(ce,{align:"right"},{default:i(()=>[l($,{flat:"",color:"primary",label:"Add to list",onClick:v})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(nt,{modelValue:m.value.show,"onUpdate:modelValue":n[1]||(n[1]=t=>m.value.show=t),onAdd:k},null,8,["modelValue"])],64))}},lt={class:"text-grey-8 q-gutter-xs flex items-center"},ot=D("span",{class:"text-bold"},"Zutaten pro Portion:",-1),it=D("span",{class:"text-bold"},"Sub-dishes:",-1),vt=Object.assign({name:"ListPage"},{__name:"menu.page",setup(e){Ye();const y=le("notify"),g=je();S(!1);const r=S(!0),d=S(""),s=S({show:!1,dishes:[]}),m=Ke(),c=S([]),v=function(a){a.amount=a.amount==0?a.dish.standardAmount:a.amount+1,r.value=!1},f=function(a){a.amount-=1,r.value=M.sum(c.value.map(n=>n.amount))==0},k=()=>{s.value.dishes=M.cloneDeep(c.value.filter(a=>a.amount>0)),s.value.dishes.forEach(a=>{var n;a.dish.ingredients.forEach(t=>{t.amount.value=t.amount.unit!=null?t.amount.value*a.amount:t.amount.value}),(n=a.dish.subdishes)==null||n.forEach(t=>{t.dish=c.value.find(o=>o.dish._id==t.dish).dish,t.dish.ingredients.forEach(o=>{a.dish.ingredients.push({name:o.name,amount:{value:o.amount.value*a.amount*t.amountFactor,unit:o.amount.unit},optional:o.optional||t.optional,subdish:t.dish.title})})})}),s.value.show=!0},b=async a=>{await m.addToList(a)&&y("Ingredients added to list!",{actions:[{label:"Show",color:"white",handler:()=>{g.push("/list")}}]}),c.value.forEach(n=>n.amount=0),r.value=!0};Re(async()=>{await m.fetchMenu(),c.value=m.menu.dishes.map(a=>({dish:a,amount:0})).sort((a,n)=>a.dish.title.localeCompare(n.dish.title))});const x=_(()=>d.value?c.value.filter(a=>JSON.stringify(a.dish).toLowerCase().includes(d.value.toLowerCase())):c.value),q=a=>a.amount.unit==null?a.name:a.amount.unit==""?`${a.amount.value} ${a.name}`:`${a.amount.value} ${a.amount.unit} ${a.name}`;return(a,n)=>(p(),L(Fe,null,{default:i(()=>[c.value.length>0?(p(),L(me,{key:0,class:"q-pt-md"},{default:i(()=>[l(H,{class:"flex justify-center"},{default:i(()=>[l(P,{modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=t=>d.value=t),standout:"",rounded:"",dense:"",clearable:"",placeholder:"Mmmmhhhes Schompf",style:{width:"60%","min-width":"300px"}},{prepend:i(()=>[l(B,{name:"search"})]),_:1},8,["modelValue"])]),_:1}),(p(!0),j(R,null,G(x.value,t=>(p(),L(Ze,{"expand-icon-toggle":"","switch-toggle-side":"",key:t.dish.id,"content-inset-level":1},{header:i(()=>[l(V,null,{default:i(()=>[l(A,null,{default:i(()=>[w(I(t.dish.title),1)]),_:2},1024),l(A,{caption:""},{default:i(()=>[w("\xDCbliche Menge: "+I(t.dish.standardAmount),1)]),_:2},1024)]),_:2},1024),l(V,{side:""},{default:i(()=>[D("div",lt,[l($,{color:"red",disable:t.amount==0,flat:"",round:"",icon:"remove",onClick:o=>f(t)},null,8,["disable","onClick"]),D("span",null,I(t.amount),1),l($,{color:"green",flat:"",round:"",icon:"add",onClick:o=>v(t)},null,8,["onClick"])])]),_:2},1024)]),default:i(()=>[l(Z,null,{default:i(()=>[l(U,null,{default:i(()=>[ot,w(" "+I(t.dish.ingredients.map(o=>q(o)).join(", ")),1)]),_:2},1024),t.dish.subdishes&&t.dish.subdishes.length>0?(p(),L(U,{key:0},{default:i(()=>[it,w(" "+I(t.dish.subdishes.map(o=>`${o.dish} (Menge: ${o.amountFactor})`).join(", ")),1)]),_:2},1024)):z("",!0),l(K,{inset:""})]),_:2},1024)]),_:2},1024))),128))]),_:1})):z("",!0),l(He,{position:"bottom",offset:[0,18],style:{"z-index":"6000"}},{default:i(()=>[l($,{fab:"",icon:"checklist",color:"accent",onClick:k,disabled:r.value},null,8,["disabled"])]),_:1}),l(at,{"model-value":s.value.show,"onUpdate:modelValue":n[1]||(n[1]=t=>s.value.show=t),dishes:s.value.dishes,onAdd:b},null,8,["model-value","dishes"])]),_:1}))}});export{vt as default};
