import{u as $e,l as z,m as A,n as q,Q,k as ve,b as qe,e as Te,f as Ae,h as De,i as Le,j as Qe}from"./QInput.c1a12cfe.js";import{c as _e,d as xe,u as Ue,b as Y,a as Ee}from"./store.9cd64889.js";import{Q as ge}from"./QPage.960d2146.js";import{c as fe,o as Ve,h as y,bI as Oe,a9 as je,u as ke,r as T,a as C,x as le,w as Be,bZ as Me,d as ye,g as Ce,Q as j,s as me,b4 as R,bv as ne,G as S,H as E,I as t,J as l,aH as U,b_ as H,c0 as D,aN as $,aG as N,av as P,bh as te,an as L,b$ as he,L as ae,cs as ze,n as Ne,ct as He,ad as G,i as Pe,cu as Ke,j as Re,K as Fe}from"./index.330ffd26.js";import{u as Ge,a as Ye,b as Ze,Q as oe,_ as O,c as Je}from"./QDialog.870cf390.js";import{b as ue,Q as se,a as ie,r as We,c as pe}from"./QCard.494039bb.js";import{Q as Xe}from"./QChip.219c9907.js";import{d as be}from"./dayjs.min.a2188686.js";import"./axios.ab682c6b.js";import"./notify.def22913.js";import"./scroll.f0664784.js";var el=fe({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:I,emit:a}){let f=!1,i,o,d=null,v=null,r,g;function p(){i&&i(),i=null,f=!1,d!==null&&(clearTimeout(d),d=null),v!==null&&(clearTimeout(v),v=null),o!==void 0&&o.removeEventListener("transitionend",r),r=null}function V(n,_,u){_!==void 0&&(n.style.height=`${_}px`),n.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,f=!0,i=u}function x(n,_){n.style.overflowY=null,n.style.height=null,n.style.transition=null,p(),_!==g&&a(_)}function b(n,_){let u=0;o=n,f===!0?(p(),u=n.offsetHeight===n.scrollHeight?0:void 0):(g="hide",n.style.overflowY="hidden"),V(n,u,_),d=setTimeout(()=>{d=null,n.style.height=`${n.scrollHeight}px`,r=s=>{v=null,(Object(s)!==s||s.target===n)&&x(n,"show")},n.addEventListener("transitionend",r),v=setTimeout(r,e.duration*1.1)},100)}function w(n,_){let u;o=n,f===!0?p():(g="show",n.style.overflowY="hidden",u=n.scrollHeight),V(n,u,_),d=setTimeout(()=>{d=null,n.style.height=0,r=s=>{v=null,(Object(s)!==s||s.target===n)&&x(n,"hide")},n.addEventListener("transitionend",r),v=setTimeout(r,e.duration*1.1)},100)}return Ve(()=>{f===!0&&p()}),()=>y(Oe,{css:!1,appear:e.appear,onEnter:b,onLeave:w},I.default)}});const K=je({}),ll=Object.keys(ke);var tl=fe({name:"QExpansionItem",props:{...ke,...Ge,..._e,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:{},headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...Ye,"click","afterShow","afterHide"],setup(e,{slots:I,emit:a}){const{proxy:{$q:f}}=Ce(),i=xe(e,f),o=T(e.modelValue!==null?e.modelValue:e.defaultOpened),d=T(null),v=$e(),{show:r,hide:g,toggle:p}=Ze({showing:o});let V,x;const b=C(()=>`q-expansion-item q-item-type q-expansion-item--${o.value===!0?"expanded":"collapsed"} q-expansion-item--${e.popup===!0?"popup":"standard"}`),w=C(()=>{if(e.contentInsetLevel===void 0)return null;const m=f.lang.rtl===!0?"Right":"Left";return{["padding"+m]:e.contentInsetLevel*56+"px"}}),n=C(()=>e.disable!==!0&&(e.href!==void 0||e.to!==void 0&&e.to!==null&&e.to!=="")),_=C(()=>{const m={};return ll.forEach(M=>{m[M]=e[M]}),m}),u=C(()=>n.value===!0||e.expandIconToggle!==!0),s=C(()=>e.expandedIcon!==void 0&&o.value===!0?e.expandedIcon:e.expandIcon||f.iconSet.expansionItem[e.denseToggle===!0?"denseIcon":"icon"]),c=C(()=>e.disable!==!0&&(n.value===!0||e.expandIconToggle===!0)),k=C(()=>({expanded:o.value===!0,detailsId:v.value,toggle:p,show:r,hide:g})),F=C(()=>{const m=e.toggleAriaLabel!==void 0?e.toggleAriaLabel:f.lang.label[o.value===!0?"collapse":"expand"](e.label);return{role:"button","aria-expanded":o.value===!0?"true":"false","aria-controls":v.value,"aria-label":m}});le(()=>e.group,m=>{x!==void 0&&x(),m!==void 0&&W()});function de(m){n.value!==!0&&p(m),a("click",m)}function Z(m){m.keyCode===13&&J(m,!0)}function J(m,M){M!==!0&&d.value!==null&&d.value.focus(),p(m),me(m)}function re(){a("afterShow")}function ce(){a("afterHide")}function W(){V===void 0&&(V=Ue()),o.value===!0&&(K[e.group]=V);const m=le(o,ee=>{ee===!0?K[e.group]=V:K[e.group]===V&&delete K[e.group]}),M=le(()=>K[e.group],(ee,Se)=>{Se===V&&ee!==void 0&&ee!==V&&g()});x=()=>{m(),M(),K[e.group]===V&&delete K[e.group],x=void 0}}function h(){const m={class:[`q-focusable relative-position cursor-pointer${e.denseToggle===!0&&e.switchToggleSide===!0?" items-end":""}`,e.expandIconClass],side:e.switchToggleSide!==!0,avatar:e.switchToggleSide},M=[y(j,{class:"q-expansion-item__toggle-icon"+(e.expandedIcon===void 0&&o.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:s.value})];return c.value===!0&&(Object.assign(m,{tabindex:0,...F.value,onClick:J,onKeyup:Z}),M.unshift(y("div",{ref:d,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),y(q,m,()=>M)}function B(){let m;return I.header!==void 0?m=[].concat(I.header(k.value)):(m=[y(q,()=>[y(A,{lines:e.labelLines},()=>e.label||""),e.caption?y(A,{lines:e.captionLines,caption:!0},()=>e.caption):null])],e.icon&&m[e.switchToggleSide===!0?"push":"unshift"](y(q,{side:e.switchToggleSide===!0,avatar:e.switchToggleSide!==!0},()=>y(j,{name:e.icon})))),e.disable!==!0&&e.hideExpandIcon!==!0&&m[e.switchToggleSide===!0?"unshift":"push"](h()),m}function X(){const m={ref:"item",style:e.headerStyle,class:e.headerClass,dark:i.value,disable:e.disable,dense:e.dense,insetLevel:e.headerInsetLevel};return u.value===!0&&(m.clickable=!0,m.onClick=de,Object.assign(m,n.value===!0?_.value:F.value)),y(z,m,B)}function Ie(){return Be(y("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:w.value,id:v.value},ye(I.default)),[[Me,o.value]])}function we(){const m=[X(),y(el,{duration:e.duration,onShow:re,onHide:ce},Ie)];return e.expandSeparator===!0&&m.push(y(Y,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:i.value}),y(Y,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:i.value})),m}return e.group!==void 0&&W(),Ve(()=>{x!==void 0&&x()}),()=>y("div",{class:b.value},[y("div",{class:"q-expansion-item__container relative-position"},we())])}});const al={class:"q-px-md"},nl={class:"q-gutter-y-xs column"},ol={__name:"addIngredient.dialog.component",props:{modelValue:{},modelModifiers:{}},emits:R(["add"],["update:modelValue"]),setup(e,{emit:I}){const a=ne(e,"modelValue"),f=I,i=T({name:"",amount:{value:null,unit:""}}),o=()=>{a.value=!1,i.value.amount.value==""&&i.value.amount.unit==""&&(i.value.amount={value:null,unit:null}),f("add",O.cloneDeep(i.value))},d=()=>{i.value={name:"",amount:{value:null,unit:""}}};return(v,r)=>(S(),E(oe,{modelValue:a.value,"onUpdate:modelValue":r[3]||(r[3]=g=>a.value=g),position:"bottom",onHide:d},{default:t(()=>[l(ue,{style:{width:"350px"},class:"q-px-md"},{default:t(()=>[l(se,null,{default:t(()=>[U("div",al,[U("div",nl,[l(Q,{class:"text-body1",borderless:"",modelValue:i.value.name,"onUpdate:modelValue":r[0]||(r[0]=g=>i.value.name=g),dense:"",placeholder:"Title",autofocus:"",onKeyup:H(o,["enter"])},null,8,["modelValue"]),l(Q,{borderless:"",modelValue:i.value.amount.value,"onUpdate:modelValue":r[1]||(r[1]=g=>i.value.amount.value=g),dense:"",placeholder:"Value",onKeyup:H(o,["enter"])},{prepend:t(()=>[l(j,{size:"xs",name:"123"})]),_:1},8,["modelValue"]),l(Q,{borderless:"",modelValue:i.value.amount.unit,"onUpdate:modelValue":r[2]||(r[2]=g=>i.value.amount.unit=g),dense:"",placeholder:"Unit",onKeyup:H(o,["enter"])},{prepend:t(()=>[l(j,{size:"xs",name:"category"})]),_:1},8,["modelValue"])])])]),_:1}),l(ie,{align:"right"},{default:t(()=>[l(D,{flat:"",color:"primary",disable:!i.value.name,onClick:o},{default:t(()=>[$("Add")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},ul={class:"q-px-md"},sl={class:"q-gutter-y-xs column"},il={__name:"editIngredient.dialog.component",props:R({ingredient:Object},{modelValue:{},modelModifiers:{}}),emits:R(["save"],["update:modelValue"]),setup(e,{emit:I}){const a=ne(e,"modelValue"),f=e,i=I,o=T(O.cloneDeep(f.ingredient)),d=()=>{o.value={name:"",amount:{value:null,unit:""}}},v=()=>{a.value=!1,o.value.amount.value==""&&o.value.amount.unit==""&&(o.value.amount={value:null,unit:null}),i("save",O.cloneDeep(o.value))};return(r,g)=>(S(),E(oe,{modelValue:a.value,"onUpdate:modelValue":g[3]||(g[3]=p=>a.value=p),position:"bottom",onHide:d},{default:t(()=>[l(ue,{style:{width:"350px"},class:"q-px-md"},{default:t(()=>[l(se,null,{default:t(()=>[U("div",ul,[U("div",sl,[l(Q,{class:"text-body1",borderless:"",modelValue:o.value.name,"onUpdate:modelValue":g[0]||(g[0]=p=>o.value.name=p),dense:"",placeholder:"Title",autofocus:""},null,8,["modelValue"]),l(Q,{borderless:"",modelValue:o.value.amount.value,"onUpdate:modelValue":g[1]||(g[1]=p=>o.value.amount.value=p),dense:"",placeholder:"Value"},{prepend:t(()=>[l(j,{size:"xs",name:"123"})]),_:1},8,["modelValue"]),l(Q,{borderless:"",modelValue:o.value.amount.unit,"onUpdate:modelValue":g[2]||(g[2]=p=>o.value.amount.unit=p),dense:"",placeholder:"Unit"},{prepend:t(()=>[l(j,{size:"xs",name:"category"})]),_:1},8,["modelValue"])])])]),_:1}),l(ie,{align:"right"},{default:t(()=>[l(D,{flat:"",color:"primary",disable:!o.value.name,onClick:v},{default:t(()=>[$("Save")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},dl={__name:"chooseIngredients.dialog.component",props:R({dishes:Array},{modelValue:{},modelModifiers:{}}),emits:R(["add"],["update:modelValue"]),setup(e,{emit:I}){be.extend(We);const a=ne(e,"modelValue"),f=e,i=I,o=T(O.cloneDeep(f.dishes));T(null),T({show:!1});const d=T({show:!1,dish:null,ingredient:{}}),v=T({show:!1,dish:null,ingredient:null});le(()=>f.dishes,n=>{o.value=O.cloneDeep(n)});const r=()=>{const n=o.value.flatMap(_=>_.dish.ingredients);i("add",n),a.value=!1},g=n=>{d.value.dish=n,d.value.show=!0},p=n=>{d.value.dish.dish.ingredients.push(n)},V=(n,_,u)=>{v.value.dish=n,v.value.ingredient=_,v.value.show=!0},x=n=>{v.value.ingredient.name=n.name,v.value.ingredient.amount=n.amount},b=async(n,_)=>{n.dish.ingredients.splice(_,1)},w=n=>{n.due?n.due=n.due.add(1,"d"):n.due=be().add(1,"d")};return(n,_)=>(S(),N(P,null,[l(oe,{modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=u=>a.value=u),position:"bottom"},{default:t(()=>[l(ue,{style:{width:"350px"},class:"q-pa-sm"},{default:t(()=>[l(se,null,{default:t(()=>[l(ve,null,{default:t(()=>[(S(!0),N(P,null,te(o.value,u=>(S(),N(P,{key:u.dish._id},[l(A,{header:""},{default:t(()=>[$(L(u.dish.title)+" ("+L(u.amount)+" Portionen)",1)]),_:2},1024),(S(!0),N(P,null,te(u.dish.ingredients,(s,c)=>(S(),E(z,{key:c},{default:t(()=>[l(q,{side:"",top:""},{default:t(()=>[l(D,{size:"12px",flat:"",dense:"",round:"",color:"negative",icon:"remove_circle_outline",onClick:he(k=>b(u,c),["stop"])},null,8,["onClick"])]),_:2},1024),l(q,{clickable:"",onClick:k=>V(u,s)},{default:t(()=>[l(A,null,{default:t(()=>[$(L(s.name)+" ",1),s.subdish?(S(),E(pe,{key:0,class:"q-mx-sm",color:"secondary"},{default:t(()=>[$(L(s.subdish),1)]),_:2},1024)):ae("",!0),s.optional?(S(),E(pe,{key:1,class:"q-mx-sm"},{default:t(()=>[$("Optional")]),_:1})):ae("",!0),l(Xe,{removable:"",dense:"","model-value":!!s.due,onRemove:k=>s.due=null,class:"q-mx-sm",outline:"",color:"accent","text-color":"white"},{default:t(()=>[$(L(s.due.fromNow()),1)]),_:2},1032,["model-value","onRemove"])]),_:2},1024),l(A,{caption:""},{default:t(()=>[$(L(s.amount.value)+" "+L(s.amount.unit),1)]),_:2},1024)]),_:2},1032,["onClick"]),l(q,{side:""},{default:t(()=>[l(D,{size:"12px",flat:"",dense:"",round:"",icon:"trending_flat",onClick:he(k=>w(s),["stop"])},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(z,{clickable:"",onClick:s=>g(u)},{default:t(()=>[l(q,{side:"",top:""},{default:t(()=>[l(D,{size:"12px",flat:"",dense:"",round:"",color:"primary",icon:"add_circle_outline"})]),_:1}),l(q,null,{default:t(()=>[l(A,null,{default:t(()=>[$("Add ingredient...")]),_:1})]),_:1})]),_:2},1032,["onClick"])],64))),128))]),_:1})]),_:1}),l(Y,{inset:""}),l(ie,{align:"right"},{default:t(()=>[l(D,{flat:"",color:"primary",label:"Add to list",onClick:r})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(ol,{modelValue:d.value.show,"onUpdate:modelValue":_[1]||(_[1]=u=>d.value.show=u),onAdd:p},null,8,["modelValue"]),l(il,{modelValue:v.value.show,"onUpdate:modelValue":_[2]||(_[2]=u=>v.value.show=u),ingredient:v.value.ingredient,onSave:x},null,8,["modelValue","ingredient"])],64))}};function rl(e,I){const a=T(null),f=C(()=>e.disable===!0?null:y("span",{ref:a,class:"no-outline",tabindex:-1}));function i(o){const d=I.value;o!==void 0&&o.type.indexOf("key")===0?d!==null&&document.activeElement!==d&&d.contains(document.activeElement)===!0&&d.focus():a.value!==null&&(o===void 0||d!==null&&d.contains(o.target)===!0)&&a.value.focus()}return{refocusTargetEl:f,refocusTarget:i}}var cl={xs:30,sm:35,md:40,lg:50,xl:60};const ml={..._e,...He,...qe,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:e=>e==="tf"||e==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},vl=["update:modelValue"];function fl(e,I){const{props:a,slots:f,emit:i,proxy:o}=Ce(),{$q:d}=o,v=xe(a,d),r=T(null),{refocusTargetEl:g,refocusTarget:p}=rl(a,r),V=ze(a,cl),x=C(()=>a.val!==void 0&&Array.isArray(a.modelValue)),b=C(()=>{const h=G(a.val);return x.value===!0?a.modelValue.findIndex(B=>G(B)===h):-1}),w=C(()=>x.value===!0?b.value!==-1:G(a.modelValue)===G(a.trueValue)),n=C(()=>x.value===!0?b.value===-1:G(a.modelValue)===G(a.falseValue)),_=C(()=>w.value===!1&&n.value===!1),u=C(()=>a.disable===!0?-1:a.tabindex||0),s=C(()=>`q-${e} cursor-pointer no-outline row inline no-wrap items-center`+(a.disable===!0?" disabled":"")+(v.value===!0?` q-${e}--dark`:"")+(a.dense===!0?` q-${e}--dense`:"")+(a.leftLabel===!0?" reverse":"")),c=C(()=>{const h=w.value===!0?"truthy":n.value===!0?"falsy":"indet",B=a.color!==void 0&&(a.keepColor===!0||(e==="toggle"?w.value===!0:n.value!==!0))?` text-${a.color}`:"";return`q-${e}__inner relative-position non-selectable q-${e}__inner--${h}${B}`}),k=C(()=>{const h={type:"checkbox"};return a.name!==void 0&&Object.assign(h,{".checked":w.value,"^checked":w.value===!0?"checked":void 0,name:a.name,value:x.value===!0?a.val:a.trueValue}),h}),F=Te(k),de=C(()=>{const h={tabindex:u.value,role:e==="toggle"?"switch":"checkbox","aria-label":a.label,"aria-checked":_.value===!0?"mixed":w.value===!0?"true":"false"};return a.disable===!0&&(h["aria-disabled"]="true"),h});function Z(h){h!==void 0&&(me(h),p(h)),a.disable!==!0&&i("update:modelValue",J(),h)}function J(){if(x.value===!0){if(w.value===!0){const h=a.modelValue.slice();return h.splice(b.value,1),h}return a.modelValue.concat([a.val])}if(w.value===!0){if(a.toggleOrder!=="ft"||a.toggleIndeterminate===!1)return a.falseValue}else if(n.value===!0){if(a.toggleOrder==="ft"||a.toggleIndeterminate===!1)return a.trueValue}else return a.toggleOrder!=="ft"?a.trueValue:a.falseValue;return a.indeterminateValue}function re(h){(h.keyCode===13||h.keyCode===32)&&me(h)}function ce(h){(h.keyCode===13||h.keyCode===32)&&Z(h)}const W=I(w,_);return Object.assign(o,{toggle:Z}),()=>{const h=W();a.disable!==!0&&F(h,"unshift",` q-${e}__native absolute q-ma-none q-pa-none`);const B=[y("div",{class:c.value,style:V.value,"aria-hidden":"true"},h)];g.value!==null&&B.push(g.value);const X=a.label!==void 0?Ne(f.default,[a.label]):ye(f.default);return X!==void 0&&B.push(y("div",{class:`q-${e}__label q-anchor--skip`},X)),y("div",{ref:r,class:s.value,...de.value,onClick:Z,onKeydown:re,onKeyup:ce},B)}}var gl=fe({name:"QToggle",props:{...ml,icon:String,iconColor:String},emits:vl,setup(e){function I(a,f){const i=C(()=>(a.value===!0?e.checkedIcon:f.value===!0?e.indeterminateIcon:e.uncheckedIcon)||e.icon),o=C(()=>a.value===!0?e.iconColor:null);return()=>[y("div",{class:"q-toggle__track"}),y("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},i.value!==void 0?[y(j,{name:i.value,color:o.value})]:void 0)]}return fl("toggle",I)}});const hl={class:"row q-col-gutter-sm items-center"},pl={class:"col-6"},bl={class:"col-6"},_l={__name:"editDish.dialog.component",props:R({dish:Object},{modelValue:{},modelModifiers:{}}),emits:R(["save"],["update:modelValue"]),setup(e,{emit:I}){const a=ne(e,"modelValue"),f=e,i=I,o=T(O.cloneDeep(f.dish)),d=()=>{o.value=O.cloneDeep(f.dish)},v=()=>{o.value.ingredients.push({name:"",amount:{value:null,unit:""}})},r=V=>{o.value.ingredients.splice(V,1)},g=()=>{o.value={title:"",ingredients:[],standardAmount:0}},p=()=>{a.value=!1,o.value.ingredients.forEach(V=>{!V.amount&&!V.amount.unit&&(V.amount={value:null,unit:null})}),i("save",O.cloneDeep(o.value))};return(V,x)=>(S(),E(oe,{modelValue:a.value,"onUpdate:modelValue":x[2]||(x[2]=b=>a.value=b),position:"bottom",onBeforeShow:d,onHide:g},{default:t(()=>[l(ue,{style:{width:"350px"}},{default:t(()=>[l(se,null,{default:t(()=>[l(ve,null,{default:t(()=>[l(A,{header:""},{default:t(()=>[$("Name")]),_:1}),l(z,null,{default:t(()=>[l(Q,{class:"text-body1",borderless:"",modelValue:o.value.title,"onUpdate:modelValue":x[0]||(x[0]=b=>o.value.title=b),dense:"",placeholder:"Name",autofocus:"",onKeyup:H(p,["enter"])},null,8,["modelValue"])]),_:1}),l(A,{header:""},{default:t(()=>[$("Zutaten")]),_:1}),(S(!0),N(P,null,te(o.value.ingredients,(b,w)=>(S(),N(P,{key:w},[l(z,null,{default:t(()=>[l(q,{side:""},{default:t(()=>[l(D,{flat:"",dense:"",round:"",color:"negative",icon:"remove_circle_outline",size:"sm",onClick:n=>r(w)},null,8,["onClick"])]),_:2},1024),l(q,null,{default:t(()=>[l(A,null,{default:t(()=>[l(Q,{modelValue:b.name,"onUpdate:modelValue":n=>b.name=n,filled:"",dense:"",placeholder:"Title",autofocus:"",onKeyup:H(p,["enter"])},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(A,null,{default:t(()=>[U("div",hl,[U("div",pl,[l(Q,{modelValue:b.amount.value,"onUpdate:modelValue":n=>b.amount.value=n,filled:"",dense:"",onKeyup:H(p,["enter"])},{prepend:t(()=>[l(j,{size:"xs",name:"123"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),U("div",bl,[l(Q,{modelValue:b.amount.unit,"onUpdate:modelValue":n=>b.amount.unit=n,filled:"",dense:"",onKeyup:H(p,["enter"])},{prepend:t(()=>[l(j,{size:"xs",name:"category"})]),_:2},1032,["modelValue","onUpdate:modelValue"])])])]),_:2},1024)]),_:2},1024),l(q,{side:""},{default:t(()=>[l(gl,{dense:"",modelValue:b.optional,"onUpdate:modelValue":n=>b.optional=n,icon:"low_priority",color:"primary"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),l(Y,{inset:""})],64))),128)),l(z,{clickable:"",onClick:v},{default:t(()=>[l(q,{side:"",top:""},{default:t(()=>[l(D,{size:"12px",flat:"",dense:"",round:"",color:"primary",icon:"add_circle_outline"})]),_:1}),l(q,null,{default:t(()=>[l(A,null,{default:t(()=>[$("Add ingredient...")]),_:1})]),_:1})]),_:1}),l(A,{header:""},{default:t(()=>[$("\xDCbliche Menge")]),_:1}),l(z,null,{default:t(()=>[l(Q,{borderless:"",modelValue:o.value.standardAmount,"onUpdate:modelValue":x[1]||(x[1]=b=>o.value.standardAmount=b),dense:"",placeholder:"\xDCbliche Menge",autofocus:"",onKeyup:H(p,["enter"])},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(ie,{align:"right"},{default:t(()=>{var b;return[l(D,{flat:"",color:"primary",disable:((b=o.value.ingredients)==null?void 0:b.length)==0,onClick:p},{default:t(()=>[$("Save")]),_:1},8,["disable"])]}),_:1})]),_:1})]),_:1},8,["modelValue"]))}},xl={class:"text-grey-8 q-gutter-xs flex items-center"},Vl=U("span",{class:"text-bold"},"Zutaten pro Portion:",-1),kl={key:0,class:"q-mt-md"},yl=U("span",{class:"text-bold"},"Sub-dishes:",-1),Ul=Object.assign({name:"MenuPage"},{__name:"menu.page",setup(e){const I=Pe("notify"),a=Ke(),f=T(!0),i=T(""),o=T({show:!1,dishes:[]}),d=T({show:!1,dish:{}}),v=Ee(),r=T([]),g=function(u){u.amount=u.amount==0?u.dish.standardAmount:u.amount+1,f.value=!1},p=function(u){u.amount-=1,f.value=O.sum(r.value.map(s=>s.amount))==0},V=()=>{o.value.dishes=O.cloneDeep(r.value.filter(u=>u.amount>0)),o.value.dishes.forEach(u=>{var s;u.dish.ingredients.forEach(c=>{c.amount.value=c.amount.unit!=null?c.amount.value*u.amount:c.amount.value}),(s=u.dish.subdishes)==null||s.forEach(c=>{c.dish=r.value.find(k=>k.dish.id==c.dish).dish,c.dish.ingredients.forEach(k=>{u.dish.ingredients.push({name:k.name,amount:{value:k.amount.value!=null?k.amount.value*u.amount*c.amountFactor:null,unit:k.amount.unit},optional:k.optional||c.optional,subdish:c.dish.title})})})}),o.value.show=!0},x=async u=>{await v.addToList(u)&&I("Ingredients added to list!",{actions:[{label:"Show",color:"white",handler:()=>{a.push("/list")}}]}),r.value.forEach(s=>s.amount=0),f.value=!0},b=u=>{d.value.dish=u,d.value.show=!0},w=async u=>{await v.editDish(u)&&I(`${u.title} edited!`)};Re(async()=>{await v.fetchMenu(),r.value=v.menu.dishes.filter(u=>u.completed).map(u=>({dish:u,amount:0})).sort((u,s)=>u.dish.title.localeCompare(s.dish.title))});const n=C(()=>i.value?r.value.filter(u=>JSON.stringify(u.dish).toLowerCase().includes(i.value.toLowerCase())):r.value),_=u=>{let s=u.optional?"[optional] ":"";return u.amount.unit==null?s+=u.name:u.amount.unit==""?s+=`${u.amount.value} ${u.name}`:s+=`${u.amount.value} ${u.amount.unit} ${u.name}`,s};return(u,s)=>(S(),N(P,null,[l(Ae,{class:"q-py-sm bg-white text-primary"},{default:t(()=>[l(De,null,{default:t(()=>[l(Le,{class:"text-center text-weight-bold"},{default:t(()=>[$(" Menu ")]),_:1})]),_:1}),l(Y)]),_:1}),Fe(v).status=="loading"?(S(),E(ge,{key:0,class:"flex flex-center"},{default:t(()=>[l(Qe,{color:"primary",size:"xl"})]),_:1})):(S(),E(ge,{key:1},{default:t(()=>[r.value.length>0?(S(),E(ve,{key:0,class:"q-pt-md"},{default:t(()=>[l(z,{class:"flex justify-center"},{default:t(()=>[l(Q,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=c=>i.value=c),standout:"",rounded:"",dense:"",clearable:"",placeholder:"Mmmmhhhes Schompf",style:{width:"60%","min-width":"300px"}},{prepend:t(()=>[l(j,{name:"search"})]),_:1},8,["modelValue"])]),_:1}),(S(!0),N(P,null,te(n.value,c=>(S(),E(tl,{"expand-icon-toggle":"","switch-toggle-side":"",key:c.dish.id,"content-inset-level":1},{header:t(()=>[l(q,null,{default:t(()=>[l(A,null,{default:t(()=>[$(L(c.dish.title),1)]),_:2},1024),l(A,{caption:""},{default:t(()=>[$("\xDCbliche Menge: "+L(c.dish.standardAmount),1)]),_:2},1024)]),_:2},1024),l(q,{side:""},{default:t(()=>[U("div",xl,[l(D,{color:"red",disable:c.amount==0,flat:"",round:"",icon:"remove",onClick:k=>p(c)},null,8,["disable","onClick"]),U("span",null,L(c.amount),1),l(D,{color:"green",flat:"",round:"",icon:"add",onClick:k=>g(c)},null,8,["onClick"])])]),_:2},1024)]),default:t(()=>[l(z,null,{default:t(()=>[l(q,null,{default:t(()=>[U("div",null,[Vl,$(" "+L(c.dish.ingredients.map(k=>_(k)).join(", ")),1)]),c.dish.subdishes&&c.dish.subdishes.length>0?(S(),N("div",kl,[yl,$(" "+L(c.dish.subdishes.map(k=>`${r.value.find(F=>F.dish.id==k.dish).dish.title} (Menge: ${k.amountFactor})`).join(", ")),1)])):ae("",!0)]),_:2},1024),l(q,{side:""},{default:t(()=>[l(D,{flat:"",round:"",icon:"edit",onClick:k=>b(c.dish)},null,8,["onClick"])]),_:2},1024)]),_:2},1024),l(Y,{inset:""})]),_:2},1024))),128))]),_:1})):ae("",!0),l(Je,{position:"bottom",offset:[0,-28],style:{"z-index":"6000"}},{default:t(()=>[l(D,{fab:"",icon:"checklist",color:"accent",onClick:V,disabled:f.value},null,8,["disabled"])]),_:1}),l(dl,{"model-value":o.value.show,"onUpdate:modelValue":s[1]||(s[1]=c=>o.value.show=c),dishes:o.value.dishes,onAdd:x},null,8,["model-value","dishes"]),l(_l,{modelValue:d.value.show,"onUpdate:modelValue":s[2]||(s[2]=c=>d.value.show=c),dish:d.value.dish,onSave:w},null,8,["modelValue","dish"])]),_:1}))],64))}});export{Ul as default};
